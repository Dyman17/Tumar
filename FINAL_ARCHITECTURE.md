# üéØ –§–∏–Ω–∞–ª—å–Ω–∞—è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ MVP (–ë–µ–∑ –õ–æ–≥–æ–≤)

## üì° –°—Ö–µ–º–∞ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```
ESP32-CAM (QQVGA 160√ó120, 10 FPS)
        ‚Üì WiFi MJPEG Stream
–ù–æ—É—Ç–±—É–∫ (Core AI Server)
        ‚Üì WebSocket
–í–µ–±-—Å–∞–π—Ç (Real-time Dashboard)
```

---

## üõ† –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1Ô∏è‚É£ ESP32-CAM (–î–∞—Ç—á–∏–∫)
- **–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ**: QQVGA (160√ó120)
- **JPEG quality**: 12-15
- **FPS**: 10 —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö
- **–ë—É—Ñ–µ—Ä**: Single buffer
- **–§—É–Ω–∫—Ü–∏—è**: –¢–æ–ª—å–∫–æ –∑–∞—Ö–≤–∞—Ç –∏ –ø–æ—Ç–æ–∫

### 2Ô∏è‚É£ –ù–æ—É—Ç–±—É–∫ (AI Core)
- **–ü–æ—Ç–æ–∫ 1**: Capture MJPEG
- **–ü–æ—Ç–æ–∫ 2**: AI Processing (–∫–∞–∂–¥—ã–π 2-–π –∫–∞–¥—Ä)
- **–ü–æ—Ç–æ–∫ 3**: Risk Engine
- **–ü–æ—Ç–æ–∫ 4**: WebSocket Server

### 3Ô∏è‚É£ –í–µ–±-—Å–∞–π—Ç (Dashboard)
- **Real-time –≤–∏–¥–µ–æ** —Å AI —Ä–∞–∑–º–µ—Ç–∫–æ–π
- **RiskScore** —Å —Ü–≤–µ—Ç–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π
- **–°—Ü–µ–Ω–∞—Ä–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: –æ–±—ä–µ–∫—Ç—ã, —Å–∫–æ—Ä–æ—Å—Ç—å, –∫–æ–Ω–≤–æ–∏
- **WebSocket** –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –±–µ–∑ –ª–∞–≥–æ–≤

---

## üß† AI Pipeline (–∫–∞–∂–¥—ã–π 2-–π –∫–∞–¥—Ä ~5 FPS)

```
Frame (160√ó120)
    ‚Üì
Upsample to 320√ó320
    ‚Üì
YOLOv8n Detection
    ‚Üì
ByteTrack Tracking
    ‚Üì
Scene Features:
  - total_vehicles
  - total_persons  
  - avg_speed
  - convoy_flag
  - direction_coherence
    ‚Üì
Risk Engine:
  RiskScore = 0.4*convoy + 0.25*speed + 0.2*direction + 0.15*thermal
    ‚Üì
Smoothed Risk = 0.8*prev + 0.2*current
    ‚Üì
WebSocket Broadcast
```

---

## ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏

### FPS Control
- **–í—Ö–æ–¥**: 10 FPS
- **–û–±—Ä–∞–±–æ—Ç–∫–∞**: 5 FPS (–∫–∞–∂–¥—ã–π 2-–π –∫–∞–¥—Ä)
- **–í—ã—Ö–æ–¥**: 10 FPS (—Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏)

### Risk Smoothing
```python
risk_smoothed = 0.8 * prev_risk + 0.2 * current_risk
```

### Alert Logic
```python
if risk_smoothed > 0.6:
    status = "ALERT"
else:
    status = "MONITOR" if risk_smoothed > 0.3 else "NORMAL"
```

---

## üé® –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–±–µ–∑ –±—ç–∫–µ–Ω–¥–∞)

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- **–í–∏–¥–µ–æ –ø–æ—Ç–æ–∫**: MJPEG —Å AI —Ä–∞–∑–º–µ—Ç–∫–æ–π
- **Risk –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä**: –¶–≤–µ—Ç–æ–≤–∞—è –ø–æ–ª–æ—Å–∞ (–∑–µ–ª–µ–Ω—ã–π/–∂–µ–ª—Ç—ã–π/–∫—Ä–∞—Å–Ω—ã–π)
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: 
  - –û–±—ä–µ–∫—Ç—ã: `vehicles: 4, persons: 2`
  - –°–∫–æ—Ä–æ—Å—Ç—å: `avg: 3.2 m/s`
  - –ö–æ–Ω–≤–æ–∏: `detected: YES`
- **–°–æ–±—ã—Ç–∏—è**: –¢–æ–ª—å–∫–æ —Ç–µ–∫—É—â–∏–µ, –±–µ–∑ –∏—Å—Ç–æ—Ä–∏–∏

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **Frontend**: HTML5 + JavaScript + WebSocket
- **–°—Ç–∏–ª—å**: –¢–µ–º–Ω–∞—è —Ç–µ–º–∞, –º–∏–Ω–∏–º–∞–ª–∏–∑–º
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è**: Real-time –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

---

## üìä –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö (WebSocket)

```json
{
  "frame_id": 1234,
  "timestamp": 1709049201.123,
  "video_frame": "base64_jpeg_data",
  "risk_score": 0.74,
  "risk_level": "ALERT",
  "scene": {
    "vehicles": 4,
    "persons": 2,
    "avg_speed": 3.2,
    "convoy_detected": true,
    "thermal_active": false
  },
  "fps": 9.8
}
```

---

## üöÄ –ó–∞–ø—É—Å–∫ –≤ –æ–¥–∏–Ω –∫–ª–∏–∫

```bash
# 1. –ó–∞–ø—É—Å–∫ ESP32-CAM
# 2. –ó–∞–ø—É—Å–∫ AI —Å–µ—Ä–≤–µ—Ä–∞
python main.py

# 3. –û—Ç–∫—Ä—ã—Ç—å –±—Ä–∞—É–∑–µ—Ä
http://localhost:8000
```

---

## üíæ –ü–∞–º—è—Ç—å –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### ESP32-CAM
- **RAM**: < 1MB (—Ç–æ–ª—å–∫–æ JPEG –±—É—Ñ–µ—Ä)
- **CPU**: < 20%
- **WiFi**: ~250 KB/s –ø—Ä–∏ 10 FPS

### –ù–æ—É—Ç–±—É–∫ (Core i5)
- **RAM**: ~1.5GB (YOLOv8n + —Ç—Ä–µ–∫–∏–Ω–≥)
- **CPU**: ~30-40% (5 FPS AI)
- **–°–µ—Ç—å**: ~300 KB/s

---

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
- QQVGA = –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ WiFi
- 5 FPS AI = –Ω–µ—Ç –ø–µ—Ä–µ–≥—Ä–µ–≤–∞ CPU
- –°–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ —Ä–∏—Å–∫–∞ = –Ω–µ—Ç "–ø—Ä—ã–∂–∫–æ–≤"

### ‚úÖ –ü—Ä–æ—Å—Ç–æ—Ç–∞
- –ë–µ–∑ –ª–æ–≥–æ–≤ = –±–µ–∑ –±–∞–≥–æ–≤ —Ö—Ä–∞–Ω–µ–Ω–∏—è
- –ë–µ–∑ –ë–î = –±–µ–∑ —Ç–æ—á–µ–∫ –æ—Ç–∫–∞–∑–∞
- Real-time = –±–µ–∑ –∑–∞–¥–µ—Ä–∂–µ–∫

### ‚úÖ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è
- –ß–∏—Å—Ç—ã–π –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫ —Å AI —Ä–∞–∑–º–µ—Ç–∫–æ–π
- –ü–æ–Ω—è—Ç–Ω—ã–π RiskScore
- –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### YOLOv8n –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
```python
# Upsample –¥–ª—è –ª—É—á—à–µ–π –¥–µ—Ç–µ–∫—Ü–∏–∏
frame_small = cv2.resize(frame, (160, 120))
frame_upsampled = cv2.resize(frame_small, (320, 320))
detections = model(frame_upsampled)
```

### ByteTrack –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
```python
tracker = Tracker(
    max_disappeared=50,  # —É–≤–µ–ª–∏—á–µ–Ω –¥–ª—è QQVGA
    trajectory_length=10
)
```

### Thermal –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
```python
# –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
if time() - last_thermal_update > 300:
    thermal_data = get_thermal_data(location)
```

---

## üé¨ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π

1. **–ó–∞–ø—É—Å–∫**: `python main.py`
2. **–û—Ç–∫—Ä—ã—Ç—å**: `http://localhost:8000`
3. **–ù–∞–±–ª—é–¥–∞—Ç—å**: Real-time AI –∞–Ω–∞–ª–∏–∑
4. **–ü–æ–∫–∞–∑–∞—Ç—å**: RiskScore –ø—Ä–∏ –∫–æ–Ω–≤–æ–µ/–∞–Ω–æ–º–∞–ª–∏–∏
5. **–û–±—ä—è—Å–Ω–∏—Ç—å**: –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ–æ—Ä–º—É–ª–∞ —Ä–∏—Å–∫–∞

---

## üèÜ –ò—Ç–æ–≥

**–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ AI-–∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–∞ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∫ –∂–µ–ª–µ–∑—É.**

–ë–µ–∑ –ª–æ–≥–æ–≤. –ë–µ–∑ –ë–î. –ë–µ–∑ –ª–∏—à–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏.
–¢–æ–ª—å–∫–æ —á–∏—Å—Ç—ã–π AI + Real-time –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.
